<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
      <meta charset="utf-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>Sufficiently Random/Teensy Pass 2 design phase</title>
      <!-- Latest compiled and minified CSS -->

      <link rel="stylesheet" type="text/css" href="../css/stylesheet.css" media="screen" />
      <link rel="stylesheet" type="text/css" href="../css/pygment_trac.css" media="screen" />
      <link rel="stylesheet" type="text/css" href="../css/pandoc.css" media="screen" />

      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>

    <body>

      <header>
        <div class="container">
          <h1>~/mvc/<a href="../">sufficiently_random</a>/Teensy Pass 2 design phase</h1>
        </div>
        <div><h2></h2></div>
      </header>

      <div class="container">

          <div class="info">
    Posted on January 29, 2014
    
</div>
<h2>Teensy Pass 2 design phase</h2>
<p>So awhile back I started a python project on <a href="https://github.com/TeensyPass/teensycli">github</a> (called TeensyPass) to play around with link argparse and making a more testable port my favorite password manager (<a href="http://www.zx2c4.com/projects/password-store/">password-store</a>). The project allowed me to play with tools like <a href="travis-ci.org">travis ci</a> as well as some python packaging infrastructure.</p>
<p>That said, I’ve decided to port the project to haskell<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. As such I think now is a good time to reiterate some feature I think are in a good password manager (i.e. why I don’t use some of the more fancy alternatives out there).</p>
<h2 id="design-goals">Design Goals</h2>
<ol style="list-style-type: decimal">
<li><p>K.I.S.S. <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>: I don’t want every feature imaginable…what I want is for it to work and work well….</p></li>
<li><p>Portable/human readable format : should be readable (somehow) even without the program <a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a></p></li>
<li><p>Easy to test/prove correctness : This includes auditing the source code (so no proprietary code)</p></li>
<li><p>Easy to use CLI : So that probably means autocomplete…plus then its easy to script!</p></li>
<li><p>Version control and sync : I want to be able to roll back and backup!</p></li>
</ol>
<h2 id="issues-with-current-software">Issues with current Software</h2>
<p>This list is by no means complete. There is a surplus of password management software available and so I suspect at least one currently exists that meets my criteria (spoiler there’s something very close in this list).</p>
<ul>
<li>Lastpass : I used last pass for about 2 years and loved it…that said as you can see it wasn’t a perfect fit.</li>
</ul>
<ol style="list-style-type: decimal">
<li>Proprietary</li>
<li>Opaque format (although it does export which earns it a)</li>
</ol>
<ul>
<li>Keepass : Keepass is another one tool I used for awhile. While its ubiquity was nice and even had a command line interface, it seems to suffer from feature bloat</li>
</ul>
<ol style="list-style-type: decimal">
<li>Opaque format</li>
<li>Complicated structure</li>
</ol>
<ul>
<li>password-store : My current gold standard, my second brain</li>
</ul>
<ol style="list-style-type: decimal">
<li>Because its a script, it tends to be hard to test its correctness…and looks like its held together by gum</li>
</ol>
<ul>
<li><a href="https://github.com/sol/pwsafe">pwsafe</a> : I haskell based utility I found on github, seems like there’s a few other utilities with the same though…</li>
</ul>
<ol style="list-style-type: decimal">
<li>Almost exactly what I want…my only fear is that the code may try to do too much</li>
<li>I also (perhaps due to habit?) prefer the password-store command line interface</li>
<li>The CLI parsing code is utilizes GetOpt which works but is abit fragile</li>
<li>The license is abit odd, its custom, but its still open source which is nice</li>
</ol>
<h2 id="development-plan">Development Plan</h2>
<p>Given how close pwsafe to my idea password manager, I announce the following development plan:</p>
<ol style="list-style-type: decimal">
<li><p>Separate into project into 2 projects: CLI and back-end</p></li>
<li>Write (in haskell) a command line parser to emulate password-store</li>
<li><p>So far it looks like optparse-applicative is the best way to do this.</p></li>
<li><p>Explore adapting pwsafe for this new front-end or write small wrapper library</p></li>
</ol>
<h2 id="parser-design">Parser Design</h2>
<p>Here’s the pass help output</p>
<pre><code>Usage:
   pass init [--reencrypt,-e] gpg-id
       Initialize new password storage and use gpg-id for encryption.
       Optionally reencrypt existing passwords using new gpg-id.
   pass [ls] [subfolder]
       List passwords.
   pass [show] [--clip,-c] pass-name
       Show existing password and optionally put it on the clipboard.
       If put on the clipboard, it will be cleared in 45 seconds.
   pass insert [--echo,-e | --multiline,-m] [--force,-f] pass-name
       Insert new password. Optionally, the console can be enabled echo
       the password back. Or, optionally, it may be multiline. Prompt
       before overwriting existing password unless forced.
   pass edit pass-name
       Insert a new password or edit an existing password using emacsclient -c.
   pass generate [--no-symbols,-n] [--clip,-c] [--force,-f] pass-name pass-length
       Generate a new password of pass-length with optionally no symbols.
       Optionally put it on the clipboard and clear board after 45 seconds.
       Prompt before overwriting existing password unless forced.
   pass rm [--recursive,-r] [--force,-f] pass-name
       Remove existing password or directory, optionally forcefully.
   pass git git-command-args...
       If the password store is a git repository, execute a git command
       specified by git-command-args.
   pass help
       Show this text.
   pass version
       Show version information.
   
More information may be found in the pass(1) man page.</code></pre>
<p>As you can see, pass first selects which type of command it is followed by actually having option parsing. From my experience, this is easiest done by dispatching to a separate parser based on the argument. From my first overview of the optparse-applicative this seems to be more than doable.</p>
<p>One nice feature of exactly replicating the pass CLI (aside from my familiarity with it) is reusing all the zsh, bash scripts and auto-complete plugins developed for it.</p>
<p>Lastly, I tentatively plan to call the binary tpass and potentially symlink pass -&gt; tpass once I feel the project is stable enough. If you have any opinions on the matter, feel free to tweet me at <span class="citation">@mvcisback</span></p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>My new favorite language as it were<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Keep it simple stupid<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>For example if its based on JSON + RSA…<a href="#fnref3">↩</a></p></li>
</ol>
</div>

      </div>

      <div class="footer">
        <div>
          <a href="../atom.xml">
            <img border="0" alt="atom.xml" src="../images/Feed-icon.svg" width="10" height="30" style="background-color: transparent" ; />
            Contact: <a href="https://twitter.com/mvcisback">@mvcisback</a>
            Code: <a href="https://github.com/mvcisback">Github</a>

          </div>
          <div>
            this site = 
            <a href="http://jaspervdj.be/hakyll">Hakyll</a> + 
            <a href="http://sundaykofax.github.io/baby-legs/">Theme</a> +
            <a href="http://pages.github.com/">Github Pages</a> +
            <a href="https://github.com/mvcisback/mvcisback.github.com">Source</a> +
            too much time
          </div>
      </div>
    </body>
</html>
